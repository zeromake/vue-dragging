!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.VueDragging=t():e.VueDragging=t()}(this,function(){return function(e){function t(r){if(n[r])return n[r].exports;var i=n[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,t),i.l=!0,i.exports}var n={};return t.m=e,t.c=n,t.i=function(e){return e},t.d=function(e,n,r){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:r})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=0)}([function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e){function t(e){var t=l(e.target),n=t.getAttribute("drag_group"),r=t.getAttribute("drag_key"),i=y.new(n),a=i.KEY_MAP[r],o=i.List.indexOf(a);s.addClass(t,"dragging"),e.dataTransfer&&(e.dataTransfer.effectAllowed="move",e.dataTransfer.setData("text",JSON.stringify(a))),$={index:o,item:a,el:t,group:n}}function n(e){return e.preventDefault&&e.preventDefault(),!1}function r(e){var t=void 0;if("touchmove"===e.type?(e.stopPropagation(),e.preventDefault(),t=c(e),t=l(t)):t=l(e.target),t&&$){var n=t.getAttribute("drag_group");if(n===$.group&&$.el&&$.item&&t!==$.el){var r=t.getAttribute("drag_key"),i=y.new(n),a=i.KEY_MAP[r];if(a!==$.item){var o=i.List.indexOf(a),s=i.List.indexOf($.item);g(i.List,s,o),$.index=o,u.$emit("dragged",{draged:$.item,to:a,value:i.value,group:n},n)}}}}function i(e){s.removeClass(l(e.target),"drag-over","drag-enter")}function a(){}function f(e){var t=l(e.target);s.removeClass(t,"dragging","drag-over","drag-enter"),$=null;var n=t.getAttribute("drag_group");u.$emit("dragend",{group:n},n)}function d(e){return e.preventDefault(),e.stopPropagation&&e.stopPropagation(),!1}function l(e){if(e)for(;e.parentNode;){if(e.getAttribute&&e.getAttribute("drag_block"))return e;e=e.parentNode}}function g(t,n,r){var i=t[r];return b?(t.$set(r,t[n]),t.$set(n,i)):(e.set(t,r,t[n]),e.set(t,n,i)),t}function c(e){var t=e.touches[0];return document.elementFromPoint(t.clientX,t.clientY)}function v(e,o,u){var l=o.value.item,g=o.value.list,c=y.new(o.value.group),v=b?o.value.key:u.key;c.value=o.value,c.className=o.value.className,c.KEY_MAP[v]=l,g&&c.List!==g&&(c.List=g),e.setAttribute("draggable","true"),e.setAttribute("drag_group",o.value.group),e.setAttribute("drag_block",o.value.group),e.setAttribute("drag_key",v),s.on(e,"dragstart",t),s.on(e,"dragenter",r),s.on(e,"dragover",n),s.on(e,"drag",a),s.on(e,"dragleave",i),s.on(e,"dragend",f),s.on(e,"drop",d),s.on(e,"touchstart",t),s.on(e,"touchmove",r),s.on(e,"touchend",f)}function p(e,o,u){var l=y.new(o.value.group),g=b?o.value.key:u.key;l.KEY_MAP[g]=void 0,s.off(e,"dragstart",t),s.off(e,"dragenter",r),s.off(e,"dragover",n),s.off(e,"drag",a),s.off(e,"dragleave",i),s.off(e,"dragend",f),s.off(e,"drop",d),s.off(e,"touchstart",t),s.off(e,"touchmove",r),s.off(e,"touchend",f)}function h(e){var t=e.group,n=e.dragend,r=e.dragged,i=e.list;if(i){var a=y.new(t);a.List!==i&&(a.List=i)}r&&u.$on("dragged",r,t),n&&u.$on("dragend",n,t)}function m(e){var t=e.group,n=e.dragged,r=e.dragend;n&&u.$off("dragged",n,t),r&&u.$off("dragend",r,t)}var b="1"===e.version.split(".")[0],y=new o,$=null;e.prototype.$dragging=u,b?(e.directive("dragging",{update:function(e,t){v(this.el,{modifiers:this.modifiers,arg:this.arg,value:e,oldValue:t})},unbind:function(e,t){p(this.el,{modifiers:this.modifiers,arg:this.arg,value:e||{group:this.el.getAttribute("drag_group")},oldValue:t})}}),e.directive("dragevent",{update:function(e,t){var n=t.dragged,r=t.dragend;n&&u.$off("dragged",n),r&&u.$off("dragend",r),h(e)},unbind:m})):(e.directive("dragging",{bind:v,update:function(e,t,n){var r=y.new(t.value.group),i=t.value.item,a=t.value.list,o=n.key,u=r.KEY_MAP[o];i&&u!==i&&(r.KEY_MAP[o]=i),a&&r.List!==a&&(r.List=a)},unbind:p}),e.directive("dragevent",{bind:function(e,t){h(t.value)},update:function(e,t){m(t.oldValue),h(t.value)},unbind:function(e,t){m(t.value)}}))}var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=function(){function e(){r(this,e),this.data={}}return a(e,[{key:"new",value:function(e){return this.data[e]||(this.data[e]={className:"",List:[],KEY_MAP:{}}),this.data[e]}},{key:"get",value:function(e){return this.data[e]}}]),e}(),u={listeners:{},$on:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"$default";this.listeners[n]||(this.listeners[n]={}),this.listeners[n][e]||(this.listeners[n][e]=[]),this.listeners[n][e].push(t)},$once:function(e,t){function n(a){i.$off(e,n,r),t(a)}var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"$default",i=this;this.$on(e,n,r)},$off:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"$default";if(!t||!this.listeners[n]||!this.listeners[n][e])return void(this.listeners[n]?this.listeners[n][e]=[]:this.listeners[n]={});this.listeners[n][e]=this.listeners[n][e].filter(function(e){return e!==t})},$emit:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"$default",r=this.listeners[n]?this.listeners[n][e]:null;if(r&&r.length>0)r.forEach(function(e){e(t)});else if("$default"!==n){var i=this.listeners.$default?this.listeners.$default[e]:null;i&&i.length>0&&i.forEach(function(e){e(t)})}}},s={on:function(e,t,n){e.addEventListener(t,n)},off:function(e,t,n){e.removeEventListener(t,n)},addClass:function(e,t){if(arguments.length<2)e.classList.add(t);else for(var n=1,r=arguments.length;n<r;n++)e.classList.add(arguments[n])},removeClass:function(e,t){if(arguments.length<2)e.classList.remove(t);else for(var n=1,r=arguments.length;n<r;n++)e.classList.remove(arguments[n])}};e.exports=i}])});